"use strict";(self.webpackChunkreach=self.webpackChunkreach||[]).push([[7579],{67579:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var i=n(73216),r=n(57167),a=n(70579),o=n(65043);const s="meet.jit.si";var c=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))};let l;const d=function(){return l||(l=((e,t,n)=>c(void 0,void 0,void 0,(function*(){return new Promise(((i,r)=>{if(window.JitsiMeetExternalAPI)return i(window.JitsiMeetExternalAPI);const a=document.createElement("script"),o=t?"?release=".concat(t):"",s=n?"".concat(n,"/"):"";a.async=!0,a.src="https://".concat(e,"/").concat(s,"external_api.js").concat(o),a.onload=()=>i(window.JitsiMeetExternalAPI),a.onerror=()=>r(new Error("Script load error: ".concat(a.src))),document.head.appendChild(a)}))})))(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,arguments.length>1?arguments[1]:void 0,arguments.length>2?arguments[2]:void 0),l)};let m=0;const u=e=>"".concat(e,"-").concat(m++),f=e=>{let{domain:t=s,roomName:n,configOverwrite:i,interfaceConfigOverwrite:r,jwt:c,invitees:l,devices:m,userInfo:f,release:x,lang:h,spinner:v,onApiReady:g,onReadyToClose:p,getIFrameRef:j}=e;const[b,y]=(0,o.useState)(!0),[w,_]=(0,o.useState)(!1),N=(0,o.useRef)(),M=(0,o.useRef)(),k=(0,o.useRef)(null),C=(0,o.useMemo)((()=>u("jitsiMeeting")),[u]);(0,o.useEffect)((()=>{d(t,x,(e=>{const t=e.split("/");if(!(t.length<=1))return t[0]})(n)).then((e=>{N.current=e,_(!0)})).catch((e=>console.error(e.message)))}),[]);const S=(0,o.useCallback)((e=>{M.current=new e(t,{roomName:n,configOverwrite:i,interfaceConfigOverwrite:r,jwt:c,invitees:l,devices:m,userInfo:f,release:x,lang:h,parentNode:k.current}),y(!1),M.current&&("function"===typeof g&&g(M.current),M.current.on("readyToClose",(()=>{"function"===typeof p&&p()})),k.current&&"function"===typeof j&&j(k.current))}),[M,k,g,p,j,t,n,i,r,c,l,m,f,x,h]);(0,o.useEffect)((()=>{w&&!M.current&&N.current&&S(N.current)}),[w,S]);const E=(0,o.useCallback)((()=>v?!b||M.current?null:(0,a.jsx)(v,{},void 0):null),[v,M.current]);return(0,a.jsxs)(a.Fragment,{children:[E(),(0,a.jsx)("div",{id:C,ref:k},C)]},void 0)};var x=n(27951),h=n(5701),v=n(20782),g=n(83910),p=n(97929),j=n(79061);const b=n(15526).l.injectEndpoints({endpoints:e=>({extendSlotAvailable:e.mutation({query:e=>{let{meeting_id:t}=e;return{url:"/member/extendslotAvailable",method:"POST",body:{meeting_id:t}}}}),joinMeeting:e.mutation({query:e=>{let{meeting_id:t,member_id:n}=e;return{url:"/member/meetingJointime",method:"POST",body:{meeting_id:t,member_id:n}}}}),leftMeeting:e.mutation({query:e=>{let{meeting_id:t,member_id:n}=e;return{url:"/member/meetinglefttime",method:"POST",body:{meeting_id:t,member_id:n}}}}),updateExpertPayment:e.mutation({query:e=>{let{meeting_id:t}=e;return{url:"/member/meeting_ended/".concat(t),method:"GET"}}}),checkExpertRating:e.mutation({query:e=>{let{meeting_id:t}=e;return{url:"/specialists/specialistAlreadyRated",method:"POST",body:{meeting_id:t}}}}),expertRating:e.mutation({query:e=>{let{meeting_id:t,rating:n,review:i}=e;return{url:"/specialists/specialistRating",method:"POST",body:{meeting_id:t,rating:n,review:i}}}})}),overrideExisting:!0}),{useExtendSlotAvailableMutation:y,useJoinMeetingMutation:w,useLeftMeetingMutation:_,useUpdateExpertPaymentMutation:N,useCheckExpertRatingMutation:M,useExpertRatingMutation:k}=b;var C=n(48075),S=n(86178),E=n.n(S),O=n(81919),T=n(30064),A=n.n(T),I=n(99410),R=n(61052);const P=()=>{var e,t,n;const s=(0,r.gL)("userData"),c=(0,i.zy)(),l=(0,i.Zp)(),{socket:d}=(0,I.Y)(),[m]=y(),[u]=w(),[b]=_(),[S]=N(),[T]=M(),[P]=k(),[J]=(0,O.js)(),{showModal:D,hideModal:L}=(0,C.Vv)(),[W,F]=(0,o.useState)(!1),[B,Y]=(0,o.useState)(!1),[q,z]=(0,o.useState)(!1),[Q,U]=(0,o.useState)(!1),[G,Z]=(0,o.useState)(0),[$,H]=(0,o.useState)(""),[K,V]=(0,o.useState)(""),[X,ee]=(0,o.useState)(!1),te=null!==(e=null===(t=c.state)||void 0===t?void 0:t.postParams)&&void 0!==e?e:(()=>{const e=new URLSearchParams(c.search),t=e.get("call_date");return{meeting_id:e.get("meeting_id")||"demo",subject:e.get("subject")||"Reach Meet",call_date:t||void 0,duration:e.get("duration")||void 0,type:e.get("type")||void 0,is_expert:e.get("is_expert")||void 0}})(),ne=null!==(n=null===te||void 0===te?void 0:te.meeting_id)&&void 0!==n?n:Date.now(),[ie,re]=(0,o.useState)(!0),ae=()=>{var e;null!==(e=c.state)&&void 0!==e&&e.postParams?(l("/profile"),window.location.reload()):window.close()};let oe;const[se,ce]=(0,o.useState)(!1),[le,de]=(0,o.useState)(),[me,ue]=(0,o.useState)(),[fe,xe]=(0,o.useState)(),[he,ve]=(0,o.useState)(void 0),[ge,pe]=(0,o.useState)(!1);(0,o.useEffect)((()=>{de(te.call_date),je()}),[]),(0,o.useEffect)((()=>{if(null!==d&&void 0!==d&&d.connected)return d.on("meetingDuration",(e=>{e.duration&&e.meeting_id==ne&&(ue(e.duration),F(!1))})),()=>{d.off("meetingDuration")}}),[d,ne]);const je=(0,o.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;ue((t=>{if(t&&e)return t+e;if(te.duration){let e=parseInt(te.duration,10);return e<3?e*=60:e}}))}),[te.duration]);(0,o.useEffect)((()=>{if(se&&le&&me&&"call"==te.type&&te.is_expert&&0==te.is_expert){const e=new Date(le+" GMT+0000");e.setMinutes(e.getMinutes()+(me-10));let t=e.getTime()-(new Date).getTime();t=t>0?t:0;const n=setTimeout((()=>{F(!0)}),t);return()=>{clearTimeout(n)}}}),[se,le,me,te.type,fe,te.is_expert]),(0,o.useEffect)((()=>{if(fe&&se&&le&&me&&"call"==te.type){const e=new Date(le+" GMT+0000");e.setMinutes(e.getMinutes()+me);let t=e.getTime()-(new Date).getTime();return t=t>0?t:0,oe=setTimeout((()=>{fe.executeCommand("endConference")}),t),()=>{clearTimeout(oe)}}}),[se,le,me,fe,te.type]);(0,o.useEffect)((()=>{q&&D(C.ew.PAYMENT_MODAL,{onCloseCallback:ye,handleSubmit:e=>{ye(e)},hideInstruction:!0,amount:null===he||void 0===he?void 0:he.call_fee})}),[q]);const be=()=>{A().fire({title:"Payment Failed",text:"There was an issue processing your payment. Please try again.",icon:"error",showConfirmButton:!0,confirmButtonText:"OK",backdrop:"rgba(255, 255, 255, 0.5) left top no-repeat filter: blur(5px);",background:"#fff"})},ye=(0,o.useCallback)((async e=>{if("Error"===e)return be(),!1}),[he,s,ne]);(0,o.useEffect)((()=>{!he&&ge||we()}),[he,ge]);const we=async()=>{re(!0);try{if(he){L();const e=E()(he.extended_start_time).format("YYYY-MM-DD"),t=E()(he.extended_start_time).format("HH:mm"),n=await J({specialist_id:he.specialist_id,call_scheduled_date:e,call_scheduled_time:t,call_scheduled_timezone:"Europe/London",call_scheduled_reason:null,type:"AutoBooking",timeSlot:"30 min",call_status:"A",is_member:1,currency:null===s||void 0===s?void 0:s.currency,meeting_id:ne,member_id:null===s||void 0===s?void 0:s.Member_id});if("error"in n)be(),console.error("Error while extending call time: ",JSON.stringify(n.error));else{const e=me?me+30:void 0;e&&ue(e),A().fire({title:"Payment Done!",text:"Meeting time has been extended as a new slot",icon:"success",timer:5e3,showConfirmButton:!0,confirmButtonText:"OK",backdrop:"rgba(255, 255, 255, 0.5) left top no-repeat filter: blur(5px);",background:"#fff"}),e&&(null===d||void 0===d||d.emit("meetingDuration",{to_member_id:null===s||void 0===s?void 0:s.Member_id,meeting_id:ne,duration:e}),null===d||void 0===d||d.emit("meetingDuration",{to_member_id:he.specialist_member_id,meeting_id:ne,duration:e})),ve(void 0),pe(!1)}}}catch(e){console.error("Error while extend call: ",e)}finally{re(!1)}},_e=(0,o.useCallback)((async()=>{null!==s&&void 0!==s&&s.Member_id&&ne&&await u({meeting_id:ne,member_id:s.Member_id})}),[ne,null===s||void 0===s?void 0:s.Member_id]),Ne=(0,o.useCallback)((async()=>{null!==s&&void 0!==s&&s.Member_id&&ne&&await b({meeting_id:ne,member_id:s.Member_id})}),[ne,null===s||void 0===s?void 0:s.Member_id]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:(0,a.jsx)(f,{domain:"beta2.reach.boats",roomName:ne,jwt:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJyZWFjaF9hcHBfaWQiLCJpc3MiOiJyZWFjaF9hcHBfaWQiLCJzdWIiOiJiZXRhMi5yZWFjaC5ib2F0cyIsInJvb20iOiIqIn0.s0yimMdQQUuUv6TBQdkwl8wlaKhq5sClj11rBO29Is0",configOverwrite:{startWithAudioMuted:!0,startWithVideoMuted:!1,disableDeepLinking:!0,prejoinPageEnabled:!1,hideConferenceSubject:!0},userInfo:{displayName:(null===s||void 0===s?void 0:s.Member_fullname)||"Guest",email:""},getIFrameRef:e=>{e.style.height="100%",e.className="iframe-div";const t=e.parentNode;t&&t.classList.add("videolayout-parent")},onApiReady:e=>{e.addListener("videoConferenceLeft",(()=>{(async()=>{if("1"!==te.is_expert&&"call"==te.type&&!(await T({meeting_id:ne,member_id:null===s||void 0===s?void 0:s.Member_id})).data.success)return void U(!0);Ne(),ae()})()})),e.addListener("toolbarButtonClicked",(function(t){"hangup-menu"==t.key&&e.executeCommand("hangup")})),e.addListener("videoConferenceJoined",(()=>{re(!1),ce(!0),xe(e),_e()})),null!==s&&void 0!==s&&s.members_profile_picture&&e.executeCommand("avatarUrl",s.members_profile_picture)}})}),ie&&(0,a.jsx)("div",{className:"page-loader",children:(0,a.jsx)("div",{className:"page-innerLoader",children:(0,a.jsx)("div",{className:"spinner-border",role:"status",children:(0,a.jsx)("img",{src:x,alt:"Loading...",className:"img-fluid"})})})}),(0,a.jsx)("div",{children:(0,a.jsx)(h.A,{isOpen:W,centered:!0,className:"Remove-alert confirm-modal videolayout-modal",children:(0,a.jsx)(v.A,{children:(0,a.jsx)("div",{className:"confirm-box",children:(0,a.jsx)("div",{className:"confirm-box-inner",children:(0,a.jsxs)("div",{className:"row  mx-0",children:[(0,a.jsxs)("div",{className:"row content-box-new  justify-content-center",children:[(0,a.jsx)("span",{className:"icon-info",children:(0,a.jsx)(g.g,{icon:p.zpE,className:"text-warning"})}),(0,a.jsx)("p",{className:"row justify-content-center text-center",children:"Your meeting will be expired within 10 minutes. You may have to pay additional call extension fee. Do you want to continue the meeting?"})]}),(0,a.jsxs)("div",{className:"row content-box-new justify-content-center",children:[(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsx)(j.$,{onClick:async()=>{if(F(!1),ne){const e={meeting_id:ne},t=await m(e);if("error"in t)return void console.error(JSON.stringify(t.error));{const e=t.data;ve(e),pe(!0)}}},text:"Yes",icon:!1,theme:"light",className:"w-100"})}),(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsx)(j.$,{onClick:()=>F(!1),text:"No",icon:!1,theme:"dark",className:"w-100"})})]})]})})})})})}),(0,a.jsx)("div",{children:(0,a.jsx)(h.A,{isOpen:B,toggle:()=>Y(!1),centered:!0,className:"Remove-alert confirm-modal videolayout-modal",children:(0,a.jsx)(v.A,{children:(0,a.jsx)("div",{className:"confirm-box",children:(0,a.jsx)("div",{className:"confirm-box-inner",children:(0,a.jsxs)("div",{className:"row  mx-0",children:[(0,a.jsx)("div",{className:"row content-box-new  justify-content-center",children:(0,a.jsx)("p",{className:"row justify-content-center text-center",children:"No slot available to extend the meeting"})}),(0,a.jsx)("div",{className:"row content-box-new justify-content-center",children:(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsx)(j.$,{onClick:()=>Y(!1),text:"Ok",icon:!1,theme:"dark",className:"w-100"})})})]})})})})})}),(0,a.jsx)("div",{children:(0,a.jsx)(h.A,{isOpen:Q,centered:!0,className:"Remove-alert confirm-modal videolayout-modal",children:(0,a.jsx)(v.A,{children:(0,a.jsx)("div",{className:"confirm-box",children:(0,a.jsx)("div",{className:"confirm-box-inner",children:(0,a.jsxs)("div",{className:"row  mx-0",children:[(0,a.jsxs)("div",{className:"row content-box-new  justify-content-center",children:[(0,a.jsx)("span",{className:"icon-info",children:(0,a.jsx)(g.g,{icon:p.WeN,className:"text-warning"})}),(0,a.jsx)("h3",{className:"row justify-content-center text-center",children:"Rate your expert!"})]}),(0,a.jsxs)("div",{className:"row justify-content-center text-center",children:[(0,a.jsx)("div",{className:"rating-star mb-3",children:(0,a.jsx)(R.A,{onClick:e=>{Z(e)},size:30})}),!X&&(0,a.jsx)("form",{children:(0,a.jsx)("textarea",{rows:4,cols:20,className:"form-control mb-3",placeholder:"Write your feedback here...",value:$,onChange:e=>H(e.target.value)})}),X&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-warning",children:$}),(0,a.jsx)("h3",{className:"row justify-content-center text-center text-success",children:"Thank you for your feedback!"})]}),K&&(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-danger",children:K})})]}),!X&&(0,a.jsxs)("div",{className:"row content-box-new justify-content-center",children:[(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsx)(j.$,{onClick:()=>{ae(),Ne()},text:"Ask me later",icon:!1,theme:"light",className:"w-100"})}),(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsx)(j.$,{onClick:()=>(async()=>{V(""),$.trim()?G?(ee(!0),await P({meeting_id:ne,rating:G,review:$}),setTimeout((()=>{ae(),Ne()}),2500)):V("Please select a star rating to help us improve."):V("We value your feedback! Kindly share your experience.")})(),text:"Submit",icon:!1,theme:"dark",className:"w-100"})})]})]})})})})})})]})}}}]);
//# sourceMappingURL=7579.69a5c42b.chunk.js.map